{% extends "lfs/base.html" %}
{% load i18n lfs_tags %}

{% block title %}
    {% trans 'Checkout' %} - {{ block.super }}
{% endblock %}

{% block section %}checkout{% endblock %}

{% block breadcrumbs %}
    {% breadcrumbs _("Checkout") %}
{% endblock %}

{% block wrapper %}
    {% if form.errors %}
        <div class="form-errors alert alert-error">
            {% trans "The operation could not be performed because one or more errors occurred. Please see below." %}
        </div>
    {% endif %}
    <div class="col-md-12">
        <form class="checkout-form postal-address"
              method="post"
              data="{% url lfs_changed_checkout %}"
              invoice="{% url lfs_changed_invoice_country %}"
              shipping="{% url lfs_changed_shipping_country %}">
            {% csrf_token %}
            <table class="lfs-default table">
                <thead>
                    <tr>
                        <th>
                            {% trans 'Invoice address' %}
                        </th>
                        <th class="shipping_checkbox">
                            <div class="pull-left">{% trans 'Shipping address' %}&nbsp;&nbsp;</div>
                            <div class="pull-left">(</div>
                            <div class="pull-left">
                                <label class="checkbox">
                                    {{ form.no_shipping }}
                                    {{ form.no_shipping.label_tag }}
                                </label>
                            </div>
                            <div class="pull-left">)</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        {# Invoice Address #}
                        <td width="50%" id="invoice-address-inline" class="form">
                            {{ invoice_address_inline|safe }}
                        </td>

                        {#  Shipping Address #}
                        <td width="50%" class="shipping-address form" id="shipping-address-inline">
                            {{ shipping_address_inline|safe }}
                        </td>
                    </tr>
                </tbody>
            </table>

            {# Payment #}
            <div class="payment col-md-6">
                <div id="payment-inline">
                    {{ payment_inline|safe }}
                </div>
            </div>

            {# Shipping #}
            <div class="shipping col-md-6">
                <h2>{% trans 'Shipping' %}</h2>
                <div id="shipping-inline">
                    {{ shipping_inline|safe }}
                </div>
            </div>



            {% if display_credit_card %}
                 <table id="credit-card">
                     <tr>
                         <th colspan="2">
                             {% trans 'Please enter your credit card information' %}

                            {% if credit_card_form.errors.credit_card %}
                                <ul class="errorlist">
                                    <li>{{ credit_card_form.errors.credit_card }}</li>
                                </ul>
                            {% endif %}

                             <noscript>
                                 <div class="discreet">
                                     ({% trans 'Only necessary when the payment method is direct debit' %})
                                 </div>
                             </noscript>
                         </th>
                    </tr>
                     <tr>
                         <td class="label"
                             colspan="2">
                             {{ credit_card_form.type.errors }}
                         </td>
                     </tr>
                     <tr>
                         <td class="label">
                             {{ credit_card_form.type.label_tag }}:
                         </td>
                         <td>
                             {{ credit_card_form.type }}
                         </td>
                     </tr>
                     <tr>
                         <td class="label"
                             colspan="2">
                             {{ credit_card_form.owner.errors }}
                         </td>
                     </tr>
                     <tr>
                         <td class="label">
                             {{ credit_card_form.owner.label_tag }}:
                         </td>
                         <td>
                             {{ credit_card_form.owner }}
                         </td>
                     </tr>

                     <tr>
                         <td class="label"
                             colspan="2">
                             {{ credit_card_form.number.errors }}
                         </td>
                     </tr>
                     <tr>
                         <td class="label">
                             {{ credit_card_form.number.label_tag }}:
                         </td>
                         <td>
                             {{ credit_card_form.number }}
                         </td>
                     </tr>

                     <tr>
                         <td class="label">
                             <label>{% trans "Expiration date" %}:</label>
                         </td>
                         <td>
                             {{ credit_card_form.expiration_date_month }} {{ credit_card_form.expiration_date_year }}
                         </td>
                     </tr>

                     <tr>
                         <td class="label"
                             colspan="2">
                             {{ credit_card_form.verification.errors }}
                         </td>
                     </tr>
                     <tr>
                         <td class="label">
                             {{ credit_card_form.verification.label_tag }}:
                         </td>
                         <td>
                             {{ credit_card_form.verification }}
                         </td>
                     </tr>

                </table>
            {% endif %}
            {% if display_bank_account %}
                <table id="bank-account">
                    <tr>
                        <th colspan="2">
                            {% trans 'Please enter your bank information' %}
                            <noscript>
                                <div class="discreet">
                                    ({% trans 'Only necessary when the payment method is direct debit' %})
                                </div>
                            </noscript>
                        </th>
                    </tr>
                    <tr>
                        <td class="label"
                            colspan="2">
                            {{ bank_account_form.account_number.errors }}
                        </td>
                    </tr>
                    <tr>
                        <td class="label">
                            {{ bank_account_form.account_number.label_tag }}:
                        </td>
                        <td>
                            {{ bank_account_form.account_number }}
                        </td>
                    </tr>
                    <tr>
                        <td class="label"
                            colspan="2">
                            {{ bank_account_form.bank_identification_code.errors }}
                        </td>
                    </tr>
                    <tr>
                        <td class="label">
                            {{ bank_account_form.bank_identification_code.label_tag }}:
                        </td>
                        <td>
                            {{ bank_account_form.bank_identification_code }}
                        </td>
                    </tr>
                    <tr>
                        <td class="label"
                            colspan="2">
                            {{ bank_account_form.bank_name.errors }}
                        </td>
                    </tr>
                    <tr>
                        <td class="label">
                            {{ bank_account_form.bank_name.label_tag }}:
                        </td>
                        <td>
                            {{ bank_account_form.bank_name }}
                        </td>
                    </tr>
                    <tr>
                        <td class="label"
                            colspan="2">
                            {{ bank_account_form.depositor.errors }}
                        </td>
                    </tr>
                    <tr>
                        <td class="label">
                            {{ bank_account_form.depositor.label_tag }}:
                        </td>
                        <td>
                            {{ bank_account_form.depositor }}
                        </td>
                    </tr>
                </table>
            {% endif %}

            <div class="clearfix"></div>

            {# Cart #}
            <div id="cart-inline clearfix">
                {{ cart_inline }}
            </div>

            {# Message #}
            <div class="control-group">
                <div class="control-label">
                {{form.message.label_tag}}
                </div>
                <div class="controls">
                {{ form.message }}
                </div>
            </div>


            {% if SHOP.confirm_toc %}
            <div class="row">
                <div class="col-md-6">
                {% if form.errors.confirm_toc %}
                <div class="alert alert-error">{{ form.errors.confirm_toc }}</div>
                {% endif %}

                <label class="checkbox-inline" for="confirm_toc">
                    <input type="checkbox" name="confirm_toc" id="confirm_toc" />
                    <a href="/term-and-conditions" >{% trans "Accept terms and conditions" %}</a>
                </label>
                </div>
            </div>
            {% endif %}

            <div class="buttons">
                <br />
                <a class="btn btn-default"
                   href="{% url lfs.cart.views.cart %}">{% trans 'Go to cart' %}</a>
                <button class="btn btn-info pull-right"
                        type="submit">
                    {% trans 'Submit order' %}
                </button>

            </div>

            {% if request.user.is_anonymous %}
                <input type="hidden"
                       name="is_anonymous"
                       value="1" />
            {% else %}
                <input type="hidden"
                       name="is_anonymous"
                       value="0" />
            {% endif %}

        </form>
    </div>
{% endblock %}

{% block local_js %}
<script type="text/javascript">
    $('.form').addClass('form-group');
    $('.form input, .form select, textarea').addClass('form-control');
</script>
{% endblock %}

